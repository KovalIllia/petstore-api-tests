{"uid":"c44a66efee9d748c","name":"test_update_pet_with_form","fullName":"tests.test_pet_api#test_update_pet_with_form","historyId":"656720f08623ee68515bcd5371bc9c97","time":{"start":1760520297085,"stop":1760520312062,"duration":14977},"description":"Update test with handling unstable Petstore API","descriptionHtml":"<p>Update test with handling unstable Petstore API</p>\n","status":"failed","statusMessage":"AssertionError: Update failed after 5 attempts due to API instability","statusTrace":"pet_api = <src.api.pet_api.PetApi object at 0x7ff5089646a0>\npet_payload = {'category': {'id': 861197974, 'name': 'strategy'}, 'id': 117060914, 'name': 'Rex', 'photoUrls': ['https://placekitten.com/510/369'], ...}\n\n    @pytest.mark.flaky(reruns=5, reruns_delay=5)\n    def test_update_pet_with_form(pet_api, pet_payload):\n        \"\"\"Update test with handling unstable Petstore API\"\"\"\n    \n        creating_pet = pet_api.add_pet(pet_payload)\n        assert creating_pet.status_code == 200, f\"unsuccessful attempt to add a pet\"\n    \n        created_pet_data = creating_pet.json()\n        pet_id = created_pet_data[\"id\"]\n        print(f\"✅ Created pet with ID: {pet_id}\")\n    \n        PetWaiter.wait_for_pet(pet_api, pet_id, expected_status=200)\n        print(f\"✅ Pet {pet_id} confirmed available\")\n    \n        time.sleep(3)\n    \n        new_name = \"Lopik\"\n        new_status = \"sold\"\n    \n        print(f\"\uD83D\uDD04 Starting update process for pet {pet_id}\")\n    \n>       response_with_update = UpdateWaiter.wait_for_update_success(\n            pet_api,\n            pet_id,\n            pet_api.update_pet_with_form_data,\n            pet_id, new_name, new_status\n        )\n\ntests/test_pet_api.py:108: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npet_api = <src.api.pet_api.PetApi object at 0x7ff5089646a0>, pet_id = 117060914\nupdate_func = <bound method PetApi.update_pet_with_form_data of <src.api.pet_api.PetApi object at 0x7ff5089646a0>>\nargs = (117060914, 'Lopik', 'sold'), kwargs = {}, max_retries = 5, attempt = 5\nresponse = <Response [404]>\n\n    @staticmethod\n    def wait_for_update_success(pet_api, pet_id: int, update_func, *args, **kwargs):\n        max_retries = 5\n    \n        for attempt in range(1, max_retries + 1):\n            print(f\"\uD83D\uDD04 Update attempt {attempt}/{max_retries} for pet {pet_id}\")\n            \"\"\"do updating\"\"\"\n            response = update_func(*args, **kwargs)\n    \n            if response.status_code == 200:\n                print(f\"✅ Update successful on attempt {attempt}\")\n                return response\n            elif response.status_code == 404:\n                print(f\"⚠️ Update failed with 404 (attempt {attempt}), retrying...\")\n                time.sleep(2)\n            else:\n                print(f\"❌ Update failed with status {response.status_code}\")\n                return response\n    \n>       raise AssertionError(f\"Update failed after {max_retries} attempts due to API instability\")\nE       AssertionError: Update failed after 5 attempts due to API instability\n\nutils/waiters.py:88: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1760520295014,"stop":1760520295015,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pet_api","time":{"start":1760520295015,"stop":1760520295015,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api_client","time":{"start":1760520295015,"stop":1760520295015,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pet_payload","time":{"start":1760520297084,"stop":1760520297084,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Update test with handling unstable Petstore API","status":"failed","statusMessage":"AssertionError: Update failed after 5 attempts due to API instability","statusTrace":"pet_api = <src.api.pet_api.PetApi object at 0x7ff5089646a0>\npet_payload = {'category': {'id': 861197974, 'name': 'strategy'}, 'id': 117060914, 'name': 'Rex', 'photoUrls': ['https://placekitten.com/510/369'], ...}\n\n    @pytest.mark.flaky(reruns=5, reruns_delay=5)\n    def test_update_pet_with_form(pet_api, pet_payload):\n        \"\"\"Update test with handling unstable Petstore API\"\"\"\n    \n        creating_pet = pet_api.add_pet(pet_payload)\n        assert creating_pet.status_code == 200, f\"unsuccessful attempt to add a pet\"\n    \n        created_pet_data = creating_pet.json()\n        pet_id = created_pet_data[\"id\"]\n        print(f\"✅ Created pet with ID: {pet_id}\")\n    \n        PetWaiter.wait_for_pet(pet_api, pet_id, expected_status=200)\n        print(f\"✅ Pet {pet_id} confirmed available\")\n    \n        time.sleep(3)\n    \n        new_name = \"Lopik\"\n        new_status = \"sold\"\n    \n        print(f\"\uD83D\uDD04 Starting update process for pet {pet_id}\")\n    \n>       response_with_update = UpdateWaiter.wait_for_update_success(\n            pet_api,\n            pet_id,\n            pet_api.update_pet_with_form_data,\n            pet_id, new_name, new_status\n        )\n\ntests/test_pet_api.py:108: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npet_api = <src.api.pet_api.PetApi object at 0x7ff5089646a0>, pet_id = 117060914\nupdate_func = <bound method PetApi.update_pet_with_form_data of <src.api.pet_api.PetApi object at 0x7ff5089646a0>>\nargs = (117060914, 'Lopik', 'sold'), kwargs = {}, max_retries = 5, attempt = 5\nresponse = <Response [404]>\n\n    @staticmethod\n    def wait_for_update_success(pet_api, pet_id: int, update_func, *args, **kwargs):\n        max_retries = 5\n    \n        for attempt in range(1, max_retries + 1):\n            print(f\"\uD83D\uDD04 Update attempt {attempt}/{max_retries} for pet {pet_id}\")\n            \"\"\"do updating\"\"\"\n            response = update_func(*args, **kwargs)\n    \n            if response.status_code == 200:\n                print(f\"✅ Update successful on attempt {attempt}\")\n                return response\n            elif response.status_code == 404:\n                print(f\"⚠️ Update failed with 404 (attempt {attempt}), retrying...\")\n                time.sleep(2)\n            else:\n                print(f\"❌ Update failed with status {response.status_code}\")\n                return response\n    \n>       raise AssertionError(f\"Update failed after {max_retries} attempts due to API instability\")\nE       AssertionError: Update failed after 5 attempts due to API instability\n\nutils/waiters.py:88: AssertionError","steps":[{"name":"POST /pet","time":{"start":1760520297085,"stop":1760520297352,"duration":267},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"GET /pet/{petId}","time":{"start":1760520297352,"stop":1760520297640,"duration":288},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"POST /pet/pet_id","time":{"start":1760520300644,"stop":1760520300912,"duration":268},"status":"passed","steps":[{"name":"POST /pet/117060914","time":{"start":1760520300644,"stop":1760520300912,"duration":268},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pet_id","value":"117060914"},{"name":"name","value":"'Lopik'"},{"name":"status","value":"'sold'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"POST /pet/pet_id","time":{"start":1760520302915,"stop":1760520303211,"duration":296},"status":"passed","steps":[{"name":"POST /pet/117060914","time":{"start":1760520302915,"stop":1760520303211,"duration":296},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pet_id","value":"117060914"},{"name":"name","value":"'Lopik'"},{"name":"status","value":"'sold'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"POST /pet/pet_id","time":{"start":1760520305215,"stop":1760520305485,"duration":270},"status":"passed","steps":[{"name":"POST /pet/117060914","time":{"start":1760520305215,"stop":1760520305485,"duration":270},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pet_id","value":"117060914"},{"name":"name","value":"'Lopik'"},{"name":"status","value":"'sold'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"POST /pet/pet_id","time":{"start":1760520307488,"stop":1760520307762,"duration":274},"status":"passed","steps":[{"name":"POST /pet/117060914","time":{"start":1760520307488,"stop":1760520307762,"duration":274},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pet_id","value":"117060914"},{"name":"name","value":"'Lopik'"},{"name":"status","value":"'sold'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"POST /pet/pet_id","time":{"start":1760520309765,"stop":1760520310058,"duration":293},"status":"passed","steps":[{"name":"POST /pet/117060914","time":{"start":1760520309766,"stop":1760520310058,"duration":292},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"pet_id","value":"117060914"},{"name":"name","value":"'Lopik'"},{"name":"status","value":"'sold'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"438086b3427b7b29","name":"stdout","source":"438086b3427b7b29.txt","type":"text/plain","size":894}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":12,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_pet_api"},{"name":"host","value":"runnervmwhb2z"},{"name":"thread","value":"3613-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_pet_api"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":[]},"source":"c44a66efee9d748c.json","parameterValues":[]}